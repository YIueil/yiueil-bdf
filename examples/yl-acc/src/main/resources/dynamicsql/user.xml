<?xml version="1.0" encoding="UTF-8"?>
<root cache="true"
      xmlns="http://www.yiueil.cc"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.yiueil.cc https://yiueil.github.io/static-repo/static/xsd/yl-dynamic-sql.xsd">
    <config id="getUserList">
        <sql>
            <![CDATA[
                select id,
                       createtime   "createTime",
                       createuserid "createUserId",
                       email,
                       guid,
                       loginname    "loginName",
                       modifytime   "modifyTime",
                       phonenumber  "phoneNumber",
                       username     "userName",
                       state,
                       avatarurl    "avatarUrl"
                from yl_acc.user
                where 1 = 1
            ]]>
        </sql>
        <filters>
            <filter name="guid">
                <![CDATA[
                    and guid = :guid
                ]]>
            </filter>
        </filters>
        <endSql>
            <![CDATA[
                order by id
            ]]>
        </endSql>
    </config>

    <config id="getOrgUserList">
        <sql>
            <![CDATA[
                select u.id,
                       uo.createtime "createTime",
                       u.createuserid "createUserId",
                       u.email,
                       u.guid,
                       u.password,
                       u.phonenumber "phoneNumber",
                       u.username "userName",
                       u.state,
                       u.avatarurl "avatarUrl"
                from yl_acc."user" u
                         left join yl_acc.user_org uo on uo.userid = u.id
                where uo.orgid = :orgId
            ]]>
        </sql>
        <params>
            <param name="orgId"/>
        </params>
        <endSql>
            <![CDATA[
                order by uo.createTime desc
            ]]>
        </endSql>
    </config>

    <config id="addAbleUserList">
        <sql><![CDATA[
            select distinct u.id,
                   u.guid,
                   u.username "userName",
                   u.state,
                   u.avatarurl "avatarUrl",
                   u.createtime
            from yl_acc."user" u
                     left join yl_acc.user_org uo on uo.userid = u.id
            where 1 = 1
        ]]></sql>
        <filters>
            <filter name="notInOrgIds" type="numberArray"><![CDATA[
                and not exists (
                    select 1
                    from yl_acc.user_org uo2
                    where uo2.userid = u.id and uo2.orgid in (:notInOrgIds)
                )
            ]]></filter>
        </filters>
        <endSql><![CDATA[
            order by u.createTime
        ]]></endSql>
    </config>
</root>